window.__require=function e(t,i,s){function n(o,a){if(!i[o]){if(!t[o]){var h=o.split("/");if(h=h[h.length-1],!t[h]){var c="function"==typeof __require&&__require;if(!a&&c)return c(h,!0);if(r)return r(h,!0);throw new Error("Cannot find module '"+o+"'")}}var l=i[o]={exports:{}};t[o][0].call(l.exports,function(e){return n(t[o][1][e]||e)},l,l.exports,e,t,i,s)}return i[o].exports}for(var r="function"==typeof __require&&__require,o=0;o<s.length;o++)n(s[o]);return n}({1:[function(e,t,i){function s(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(e){return"function"==typeof e}function r(e){return"number"==typeof e}function o(e){return"object"==typeof e&&null!==e}function a(e){return void 0===e}t.exports=s,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._maxListeners=void 0,s.defaultMaxListeners=10,s.prototype.setMaxListeners=function(e){if(!r(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},s.prototype.emit=function(e){var t,i,s,r,h,c;if(this._events||(this._events={}),"error"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var l=new Error('Uncaught, unspecified "error" event. ('+t+")");throw l.context=t,l}if(a(i=this._events[e]))return!1;if(n(i))switch(arguments.length){case 1:i.call(this);break;case 2:i.call(this,arguments[1]);break;case 3:i.call(this,arguments[1],arguments[2]);break;default:r=Array.prototype.slice.call(arguments,1),i.apply(this,r)}else if(o(i))for(r=Array.prototype.slice.call(arguments,1),s=(c=i.slice()).length,h=0;h<s;h++)c[h].apply(this,r);return!0},s.prototype.addListener=function(e,t){var i;if(!n(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,n(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned&&(i=a(this._maxListeners)?s.defaultMaxListeners:this._maxListeners)&&i>0&&this._events[e].length>i&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},s.prototype.on=s.prototype.addListener,s.prototype.once=function(e,t){if(!n(t))throw TypeError("listener must be a function");var i=!1;function s(){this.removeListener(e,s),i||(i=!0,t.apply(this,arguments))}return s.listener=t,this.on(e,s),this},s.prototype.removeListener=function(e,t){var i,s,r,a;if(!n(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(r=(i=this._events[e]).length,s=-1,i===t||n(i.listener)&&i.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(o(i)){for(a=r;a-- >0;)if(i[a]===t||i[a].listener&&i[a].listener===t){s=a;break}if(s<0)return this;1===i.length?(i.length=0,delete this._events[e]):i.splice(s,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},s.prototype.removeAllListeners=function(e){var t,i;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n(i=this._events[e]))this.removeListener(e,i);else if(i)for(;i.length;)this.removeListener(e,i[i.length-1]);return delete this._events[e],this},s.prototype.listeners=function(e){return this._events&&this._events[e]?n(this._events[e])?[this._events[e]]:this._events[e].slice():[]},s.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(n(t))return 1;if(t)return t.length}return 0},s.listenerCount=function(e,t){return e.listenerCount(t)}},{}],Board:[function(e,t,i){"use strict";cc._RF.push(t,"e6e5a8YqTpE/Kcksaa8S4I9","Board"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){},getTilePos:function(e,t){return{posX:this.node.children[e].children[t].x,posY:this.node.children[e].y}}}),cc._RF.pop()},{}],EventEmitter:[function(e,t,i){"use strict";cc._RF.push(t,"de931AhEaFFFbGpdQf2LU6u","EventEmitter");var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}();function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=e("events"),o=function(){function e(){n(this,e),this._emitter=new r,this._emitter.setMaxListeners(100)}return s(e,[{key:"emit",value:function(){var e;(e=this._emitter).emit.apply(e,arguments)}},{key:"registerEvent",value:function(e,t){this._emitter.on(e,t)}},{key:"registerOnce",value:function(e,t){this._emitter.once(e,t)}},{key:"removeEvent",value:function(e,t){this._emitter.removeListener(e,t)}},{key:"destroy",value:function(){this._emitter.removeAllListeners(),this._emitter=null,e.instance=null}}]),e}();o.instance=null,t.exports=o,cc._RF.pop()},{events:1}],GameConfig:[function(e,t,i){"use strict";cc._RF.push(t,"51f8cKvYSVJUojB/CfOHGan","GameConfig"),t.exports={BOARD:{ROWS:5,COLS:5},TILE:[[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0]],TILE_SKIN:{2:{skin:"#EEE4DA",number:"2"},4:{skin:"#E4C5A7",number:"4"},8:{skin:"#6D9BE0",number:"8"},16:{skin:"#74E786",number:"16"},32:{skin:"#9042F3",number:"32"},64:{skin:"#E65AE6",number:"64"},128:{skin:"#D38D5E",number:"128"},256:{skin:"#42C9F3",number:"256"},512:{skin:"#D11F1F",number:"512"},1024:{skin:"#F8F85B",number:"1024"},2048:{skin:"#1A7A02",number:"2048"}}},cc._RF.pop()},{}],GernaralInit:[function(e,t,i){"use strict";cc._RF.push(t,"b5c77FurdZFSLzZYr3k14g6","GernaralInit");var s=e("EventEmitter");cc.Class({extends:cc.Component,properties:{},onLoad:function(){s.instance=new s,cc.log("Initialized")},start:function(){}}),cc._RF.pop()},{EventEmitter:"EventEmitter"}],MainController:[function(e,t,i){"use strict";cc._RF.push(t,"eef303A7xpL7IlT1oEnuEGJ","MainController");var s=e("EventEmitter");cc.Class({extends:cc.Component,properties:{_touchStartX:0,_touchStartY:0,_isPress:!1,winPanel:cc.Node,_isWinGame:!1,LosePanel:cc.Node,_isLoseGame:!1},onLoad:function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),s.instance.registerOnce("WinGame",this.isWin.bind(this)),s.instance.registerOnce("LoseGame",this.isLose.bind(this))},onKeyDown:function(e){switch(e.keyCode){case cc.macro.KEY.a:s.instance.emit("slideL");break;case cc.macro.KEY.d:s.instance.emit("slideR");break;case cc.macro.KEY.w:s.instance.emit("slideU");break;case cc.macro.KEY.s:s.instance.emit("slideD")}},onTouchStart:function(e){this._touchStartX=e.getLocationX(),this._touchStartY=e.getLocationY(),this._isPress=!1},onTouchMove:function(e){if(!this._isWinGame&&!this._isLoseGame){var t=e.getLocationX(),i=e.getLocationY(),n=t-this._touchStartX,r=i-this._touchStartY;n>10&&!this._isPress?(this._isPress=!0,s.instance.emit("slideR")):n<-10&&!this._isPress?(this._isPress=!0,s.instance.emit("slideL")):r>10&&!this._isPress?(this._isPress=!0,s.instance.emit("slideU")):r<-10&&!this._isPress&&(this._isPress=!0,s.instance.emit("slideD")),this._touchStartX=t,this._touchStartY=i}},isWin:function(){this.winPanel.active=!0,this._isWinGame=!0},isLose:function(){this.LosePanel.active=!0,this._isLoseGame=!0}}),cc._RF.pop()},{EventEmitter:"EventEmitter"}],TileGrid:[function(e,t,i){"use strict";cc._RF.push(t,"c8ef5yJDptKiLxPhdgYP3e/","TileGrid");var s=e("GameConfig"),n=e("utilities"),r=e("EventEmitter");cc.Class({extends:cc.Component,properties:{boardMap:e("Board"),tileItemPrefab:cc.Prefab},onLoad:function(){r.instance.registerEvent("slideL",this.slideLeft.bind(this)),r.instance.registerEvent("slideR",this.slideRight.bind(this)),r.instance.registerEvent("slideU",this.slideUp.bind(this)),r.instance.registerEvent("slideD",this.slideDown.bind(this)),this.init()},init:function(){this.newPos={},this.board=s.TILE,this.rows=s.BOARD.ROWS,this.cols=s.BOARD.COLS,this.createTileItem(),this.createTileItem(),this.displayBoard()},slide:function(e){e=n.filterZero(e);for(var t=0;t<e.length-1;t++)e[t]==e[t+1]&&(e[t]*=2,e[t+1]=0);for(e=n.filterZero(e);e.length<this.cols;)e.push(0);return e},slideLeft:function(){for(var e=0;e<this.rows;e++){var t=this.board[e];t=this.slide(t),this.board[e]=t;for(var i=0;i<this.cols;i++)this.board[e][i]}this.createTileItem(),this.displayBoard()},slideRight:function(){for(var e=0;e<this.rows;e++){var t=this.board[e];t.reverse(),t=this.slide(t),this.board[e]=t.reverse();for(var i=0;i<this.cols;i++);}this.createTileItem(),this.displayBoard()},slideUp:function(){for(var e=0;e<this.cols;e++){var t=[this.board[0][e],this.board[1][e],this.board[2][e],this.board[3][e],this.board[4][e]];t=this.slide(t);for(var i=0;i<this.rows;i++)this.board[i][e]=t[i]}this.createTileItem(),this.displayBoard()},slideDown:function(){for(var e=0;e<this.cols;e++){var t=[this.board[0][e],this.board[1][e],this.board[2][e],this.board[3][e],this.board[4][e]];t.reverse(),(t=this.slide(t)).reverse();for(var i=0;i<this.rows;i++)this.board[i][e]=t[i]}this.createTileItem(),this.displayBoard()},spawnTileItem:function(e){var t=cc.instantiate(this.tileItemPrefab);this.updatePos(t),t.getComponent("TileItem").setTile(e),t.parent=this.node},updatePos:function(e){e.x=this.newPos.posX,e.y=this.newPos.posY},createTileItem:function(){if(this.hasEmptyTile()&&!this.hasAvailableMoves())for(var e=!1;!e;){var t=n.random(this.rows),i=n.random(this.cols),s=Math.random()<.75?2:4;0==this.board[t][i]&&(this.board[t][i]=s,e=!0)}},displayBoard:function(){if(!this.hasEmptyTile())return this.hasAvailableMoves()?void 0:void r.instance.emit("LoseGame");this.node.removeAllChildren();for(var e=0;e<this.rows;e++)for(var t=0;t<this.cols;t++)if(0!==this.board[e][t]){var i=this.board[e][t];this.newPos=this.boardMap.getTilePos(e,t),this.spawnTileItem(s.TILE_SKIN[i]),2048===i&&r.instance.emit("WinGame")}},hasEmptyTile:function(){for(var e=0;e<this.rows;e++)for(var t=0;t<this.cols;t++)if(0==this.board[e][t])return!0;return!1},hasAvailableMoves:function(){for(var e=0;e<this.rows;e++)for(var t=0;t<this.cols;t++)if(0!==this.board[e][t]){if(t-1>=0&&this.board[e][t-1]===this.board[e][t])return!0;if(t+1<this.cols&&this.board[e][t+1]===this.board[e][t])return!0;if(e-1>=0&&this.board[e-1][t]===this.board[e][t])return!0;if(e+1<this.rows&&this.board[e+1][t]===this.board[e][t])return!0}}}),cc._RF.pop()},{Board:"Board",EventEmitter:"EventEmitter",GameConfig:"GameConfig",utilities:"utilities"}],TileItem:[function(e,t,i){"use strict";cc._RF.push(t,"57189BsghRCioeTvJqbB9zI","TileItem"),cc.Class({extends:cc.Component,properties:{mBackground:cc.Node,mNumber:cc.Label},setTile:function(e){this.mBackground.color=cc.color(e.skin),this.mNumber.string=e.number.toString()},moveTo:function(e){var t=Math.abs(e-this.node)/100;cc.tween(this.node).to(t,{position:e}).start()}}),cc._RF.pop()},{}],utilities:[function(e,t,i){"use strict";cc._RF.push(t,"c5deapwALNFIIYqxME2tpHS","utilities"),t.exports={random:function(e){return Math.floor(Math.random()*e)},filterZero:function(e){return e.filter(function(e){return 0!=e})}},cc._RF.pop()},{}]},{},["Board","GernaralInit","MainController","TileGrid","TileItem","GameConfig","EventEmitter","utilities"]);